import"../chunks/DsnmJJEf.js";import{o as at}from"../chunks/DGHSwugD.js";import{p as Ue,f as a,g as e,u as p,s as f,n as ne,t as de,a as Ee,c as Te,r as Ie,d as E,i as Ce,b as r,m as st,aQ as ot,$ as nt,h as lt}from"../chunks/BbLl-hmz.js";import{s as ue}from"../chunks/DTULLxbT.js";import{p as Z,i as H}from"../chunks/CR32N0-5.js";import{c as y,f as B,t as Y,a as t}from"../chunks/BGV7lBZC.js";import{c as i}from"../chunks/DU2gS9WV.js";import{h as it}from"../chunks/DhNQZhGX.js";import{S as Fe,B as dt,a as je,b as Je,H as ut,c as ct}from"../chunks/SAkFzdjK.js";import{e as ze,i as Qe,s as De}from"../chunks/DdZiSI1B.js";import{d as oe,T as mt,a as We,b as Ve,c as ft,e as vt,B as Re,f as _t}from"../chunks/ChvAwCEJ.js";import{E as pt,a as Ye,A as gt}from"../chunks/D2swksP8.js";import{C as Xe,S as Ze,E as $t,T as ht,a as Ge}from"../chunks/CH4y43Mi.js";import{n as qe}from"../chunks/Cmrg4eaL.js";import{E as et,L as tt,I as rt}from"../chunks/D6TB6_0Q.js";import{C as Ke}from"../chunks/nMQjHOAs.js";import{g as bt}from"../chunks/DRGeFBnA.js";import{f as yt}from"../chunks/CxOjX-KX.js";import{U as Pt}from"../chunks/Fr1dWK0I.js";import{E as xt}from"../chunks/CqQZYr2X.js";import{p as ke}from"../chunks/CD-YXIRN.js";var wt=B("<!> <!> <!>",1);function Mt(ee,o){Ue(o,!0);let n=Z(o,"loading",15,!0),u=Z(o,"openCreateModal",15,!1),v=Z(o,"hasMore",15,!1),I=Z(o,"loadingMore",15,!1);const _=["ID","Name","Public Key",""];{let R=p(()=>o.users.length===0);pt(ee,{entityType:"user",get columns(){return _},get isEmpty(){return e(R)},get onloadmore(){return o.onloadmore},get loading(){return n()},set loading(g){n(g)},get openCreateModal(){return u()},set openCreateModal(g){u(g)},get hasMore(){return v()},set hasMore(g){v(g)},get loadingMore(){return I()},set loadingMore(g){I(g)},children:(g,b)=>{var M=y(),F=a(M);ze(F,19,()=>o.users,$=>$.id,($,d,z)=>{{let s=p(()=>`/namespaces/${qe.activeId}/operators/${e(d).operator_id}/${e(d).account_id}/${e(d).id}`),c=p(()=>e(z)<o.users.length-1);Ye($,{get href(){return e(s)},get bottomBorder(){return e(c)},children:(m,xe)=>{var K=wt(),he=a(K);i(he,()=>oe,(N,G)=>{G(N,{children:(q,te)=>{{let l=p(()=>`user-id-${e(d).id}`),h=p(()=>e(d).id??"");Xe(q,{get spanId(){return e(l)},get text(){return e(h)}})}},$$slots:{default:!0}})});var ce=f(he,2);i(ce,()=>oe,(N,G)=>{G(N,{children:(q,te)=>{ne();var l=Y();de(()=>ue(l,e(d).name)),t(q,l)},$$slots:{default:!0}})});var me=f(ce,2);i(me,()=>oe,(N,G)=>{G(N,{children:(q,te)=>{{let l=p(()=>`user-pk-${e(d).id}`),h=p(()=>e(d).public_key??"");Xe(q,{get spanId(){return e(l)},get text(){return e(h)}})}},$$slots:{default:!0}})}),t(m,K)},$$slots:{default:!0}})}}),t(g,M)},$$slots:{default:!0}})}Ee()}var Tt=B("<!> <!>",1),It=B("<!> <!>",1),St=B("<p>NATS server not connected. Connect your Operator's NATS server to view streams.</p>"),Ct=B("<p>No streams found</p>"),Ut=B('<div class="text-muted-foreground my-20 text-center"><!></div>'),Et=B("<!> <!> <!> <!> <!>",1),Lt=B("<!> <!>",1),At=B('<div class="flex items-center justify-between pb-4"><h2 class="text-xl font-semibold sm:text-2xl">Streams</h2></div> <div class="overflow-x-auto"><!></div>',1);function Bt(ee,o){Ue(o,!0);let n=Z(o,"loading",11,!1),u=Z(o,"disabled",3,!1);const v=["Name","Subjects","Messages","Consumers","Created"];var I=At(),_=f(a(I),2),R=Te(_);i(R,()=>vt,(g,b)=>{b(g,{children:(M,F)=>{var $=Lt(),d=a($);i(d,()=>mt,(s,c)=>{c(s,{children:(m,xe)=>{var K=y(),he=a(K);i(he,()=>We,(ce,me)=>{me(ce,{children:(N,G)=>{var q=Tt(),te=a(q);ze(te,17,()=>v,Qe,(h,L)=>{var Q=y(),V=a(Q);i(V,()=>Ve,(S,re)=>{re(S,{class:"font-medium whitespace-nowrap",children:(le,C)=>{ne();var D=Y();de(()=>ue(D,e(L))),t(le,D)},$$slots:{default:!0}})}),t(h,Q)});var l=f(te,2);i(l,()=>Ve,(h,L)=>{L(h,{class:"w-16"})}),t(N,q)},$$slots:{default:!0}})}),t(m,K)},$$slots:{default:!0}})});var z=f(d,2);i(z,()=>ft,(s,c)=>{c(s,{children:(m,xe)=>{var K=y(),he=a(K);{var ce=N=>{var G=y(),q=a(G);i(q,()=>We,(te,l)=>{l(te,{children:(h,L)=>{var Q=It(),V=a(Q);ze(V,17,()=>v,Qe,(re,le)=>{var C=y(),D=a(C);i(D,()=>oe,(O,fe)=>{fe(O,{children:(ie,be)=>{Fe(ie,{class:"h-4 w-24"})},$$slots:{default:!0}})}),t(re,C)});var S=f(V,2);i(S,()=>oe,(re,le)=>{le(re,{})}),t(h,Q)},$$slots:{default:!0}})}),t(N,G)},me=N=>{var G=y(),q=a(G);{var te=h=>{var L=y(),Q=a(L);i(Q,()=>We,(V,S)=>{S(V,{children:(re,le)=>{var C=y(),D=a(C);{let O=p(()=>v.length+1);i(D,()=>oe,(fe,ie)=>{ie(fe,{get colspan(){return e(O)},children:(be,Le)=>{var J=Ut(),ae=Te(J);{var ye=j=>{var A=St();t(j,A)},X=j=>{var A=Ct();t(j,A)};H(ae,j=>{u()?j(ye):j(X,!1)})}Ie(J),t(be,J)},$$slots:{default:!0}})})}t(re,C)},$$slots:{default:!0}})}),t(h,L)},l=h=>{var L=y(),Q=a(L);ze(Q,19,()=>o.streams,(V,S)=>V?.name||S,(V,S,re)=>{var le=y(),C=a(le);{var D=O=>{{let fe=p(()=>u()?void 0:`/namespaces/${qe.activeId}/operators/${o.operatorId}/${o.accountId}/streams/${encodeURIComponent(e(S).name)}`),ie=p(()=>e(re)<o.streams.length-1);Ye(O,{get href(){return e(fe)},get bottomBorder(){return e(ie)},get disabled(){return u()},children:(be,Le)=>{var J=Et(),ae=a(J);i(ae,()=>oe,(x,T)=>{T(x,{children:(P,se)=>{ne();var U=Y();de(()=>ue(U,e(S).name)),t(P,U)},$$slots:{default:!0}})});var ye=f(ae,2);i(ye,()=>oe,(x,T)=>{T(x,{children:(P,se)=>{ne();var U=Y();de(w=>ue(U,w),[()=>e(S).subjects?.join(", ")||"-"]),t(P,U)},$$slots:{default:!0}})});var X=f(ye,2);i(X,()=>oe,(x,T)=>{T(x,{children:(P,se)=>{ne();var U=Y();de(w=>ue(U,w),[()=>e(S).message_count.toLocaleString()]),t(P,U)},$$slots:{default:!0}})});var j=f(X,2);i(j,()=>oe,(x,T)=>{T(x,{children:(P,se)=>{ne();var U=Y();de(()=>ue(U,e(S).consumer_count)),t(P,U)},$$slots:{default:!0}})});var A=f(j,2);i(A,()=>oe,(x,T)=>{T(x,{children:(P,se)=>{ne();var U=Y();de(w=>ue(U,w),[()=>new Date(e(S).create_time*1e3).toLocaleDateString()]),t(P,U)},$$slots:{default:!0}})}),t(be,J)},$$slots:{default:!0}})}};H(C,O=>{e(S)&&e(S).name&&O(D)})}t(V,le)}),t(h,L)};H(q,h=>{o.streams.length===0?h(te):h(l,!1)},!0)}t(N,G)};H(he,N=>{n()?N(ce):N(me,!1)})}t(m,K)},$$slots:{default:!0}})}),t(M,$)},$$slots:{default:!0}})}),Ie(_),t(ee,I),Ee()}var Nt=B('<h3 class="col-span-2 text-lg font-medium">General</h3> <div class="col-span-2"><!> <!></div> <!> <!>',1);function Dt(ee,o){Ue(o,!0);let n=Z(o,"open",15,!1),u=Z(o,"account",15),v=E(!1),I=E(Ce(u().name)),_=E(Ce(u().limits?{subscriptions:u().limits.subscriptions,payload_size:u().limits.payload_size,imports:u().limits.imports,exports:u().limits.exports,connections:u().limits.connections,user_jwt_duration_secs:u().limits.user_jwt_duration_secs}:{}));const R=new Ke;async function g(b){b.preventDefault();try{r(v,!0),u(await R.updateAccount(u().id,{name:e(I),limits:e(_)})),n(!1)}catch(M){De(M)}finally{r(v,!1)}}et(ee,{entityType:"account",modalType:"edit",get entityName(){return u().name},onsubmit:g,get open(){return n()},set open(b){n(b)},get loading(){return e(v)},set loading(b){r(v,b,!0)},children:(b,M)=>{var F=Nt(),$=f(a(F),2),d=Te($);tt(d,{for:"name",class:"mb-2",children:(m,xe)=>{ne();var K=Y("Name");t(m,K)},$$slots:{default:!0}});var z=f(d,2);rt(z,{name:"name",placeholder:"Type account name",required:!0,get value(){return e(I)},set value(m){r(I,m,!0)}}),Ie($);var s=f($,2);Ze(s,{class:"col-span-2 my-2"});var c=f(s,2);gt(c,{get limits(){return e(_)},set limits(m){r(_,m,!0)}}),t(b,F)},$$slots:{default:!0}}),Ee()}var jt=B("<!> <!>",1);function kt(ee,o){Ue(o,!0);let n=Z(o,"account",15),u=Z(o,"loading",15,!0),v=E(!1);const I=["ID","Public Key"],_=["ID","Public Key"],R=["Subscriptions","Payload Size (KiB)","Imports","Exports","Connections","User JWT Lifetime"],g=p(()=>{const s=new Map;if(n())s.set("ID",n().id),s.set("Public Key",n().public_key);else for(const c of _)s.set(c,"Unknown");return s}),b=p(()=>{const s=new Map;if(n()){const c=m=>m===-1?void 0:m;s.set("Subscriptions",c(n().limits.subscriptions)),s.set("Payload Size (KiB)",c(n().limits.payload_size)),s.set("Imports",c(n().limits.imports)),s.set("Exports",c(n().limits.exports)),s.set("Connections",c(n().limits.connections)),s.set("User JWT Lifetime",yt(n().limits.user_jwt_duration_secs))}else for(const c of R)s.set(c,"Unknown");return s});async function M(){await new Ke().deleteAccount(n().id),await bt(`/namespaces/${qe.activeId}/operators/${n().operator_id}?tab=3`)}var F=jt(),$=a(F);{let s=p(()=>n()?.name),c=p(()=>n()?.jwt);$t($,{editable:!0,get name(){return e(s)},get copyableFields(){return I},get data(){return e(g)},get limits(){return e(b)},get jwt(){return e(c)},deleteCallback:M,get loading(){return u()},set loading(m){u(m)},get openEditModal(){return e(v)},set openEditModal(m){r(v,m,!0)}})}var d=f($,2);{var z=s=>{Dt(s,{get open(){return e(v)},set open(c){r(v,c,!0)},get account(){return n()},set account(c){n(c)}})};H(d,s=>{n()&&s(z)})}t(ee,F),Ee()}var Ft=B('<h3 class="col-span-2 text-lg font-medium">General</h3> <div class="col-span-2"><!> <!></div> <!> <!>',1);function zt(ee,o){Ue(o,!0);let n=Z(o,"open",15,!1),u=Z(o,"users",31,()=>Ce([])),v=E(!1),I=E(""),_=E(Ce({}));const R=new Ke;async function g(b){b.preventDefault();try{r(v,!0);const M=await R.createUser(o.accountId,{name:e(I),limits:e(_)});u([M,...u()]),r(I,""),r(_,{},!0),n(!1)}catch(M){De(M)}finally{r(v,!1)}}et(ee,{entityType:"user",modalType:"create",onsubmit:g,get open(){return n()},set open(b){n(b)},get loading(){return e(v)},set loading(b){r(v,b,!0)},children:(b,M)=>{var F=Ft(),$=f(a(F),2),d=Te($);tt(d,{for:"name",class:"mb-2",children:(m,xe)=>{ne();var K=Y("Name");t(m,K)},$$slots:{default:!0}});var z=f(d,2);rt(z,{name:"name",placeholder:"Type user name",required:!0,get value(){return e(I)},set value(m){r(I,m,!0)}}),Ie($);var s=f($,2);Ze(s,{class:"col-span-2 my-2"});var c=f(s,2);Pt(c,{get accountUserJWTLifetime(){return o.accountUserJWTLifetime},get limits(){return e(_)},set limits(m){r(_,m,!0)}}),t(b,F)},$$slots:{default:!0}}),Ee()}var Kt=B("<!> Operators",1),Ot=B("<!> <!> <!> <!> <!> <!> <!>",1),Jt=B('<h1 class="text-3xl font-bold"> </h1>'),Wt=B('<!> <div class="mb-6"><!></div> <!>',1),Rt=B("<main><!></main> <!>",1);function fr(ee,o){Ue(o,!0);const n=p(()=>ke.params.namespace??""),u=p(()=>ke.params.operator??""),v=p(()=>ke.params.account??""),I=p(()=>{const h=new URLSearchParams(ke.url.search).get("tab");return h?parseInt(h):1});let _=E(!0),R=E(!1),g=E(!1),b=E(!1),M=E(!1),F=E(!1),$=E(void 0),d=E(void 0),z=E(Ce([])),s=E(!1),c=E(Ce([]));const m=new Ke,xe=p(()=>m.paginateUsers(e(v)));at(async()=>{r(_,!0);try{r($,await m.fetchOperator(e(u)),!0),r(d,await m.fetchAccount(e(v)),!0),await K()}catch(l){De(l),r(b,!0)}finally{r(_,!1)}}),st(()=>{e(I)===3&&e($)?.status.connected&&!e(F)&&!e(g)&&he()});async function K(){r(R,!0);try{const l=await e(xe).fetchNext();r(z,[...e(z),...l],!0),r(s,e(xe).hasNext(),!0)}catch(l){De(l)}finally{r(R,!1)}}async function he(){if(!(!e($)?.status.connected||e(F)||e(g))){r(g,!0);try{const l=await m.listStreams(e(v));r(c,Array.isArray(l)?l:[],!0)}catch(l){De(l),r(c,[],!0)}finally{r(g,!1),r(F,!0)}}}var ce=Rt();it("14pmh1x",l=>{ot(()=>{nt.title=e(d)?.name?`${e(d).name} - Coro`:"Account - Coro"})});var me=a(ce),N=Te(me);{var G=l=>{xt(l)},q=l=>{var h=Wt(),L=a(h);i(L,()=>ct,(C,D)=>{D(C,{class:"mb-8",children:(O,fe)=>{var ie=y(),be=a(ie);i(be,()=>dt,(Le,J)=>{J(Le,{children:(ae,ye)=>{var X=Ot(),j=a(X);i(j,()=>je,(w,k)=>{k(w,{children:(ve,Ae)=>{var W=y(),_e=a(W);{let pe=p(()=>`/namespaces/${e(n)}/operators`);i(_e,()=>Je,(we,Me)=>{Me(we,{get href(){return e(pe)},class:"flex items-center gap-2",children:(Se,Be)=>{var ge=Kt(),Ne=a(ge);ut(Ne,{class:"size-4"}),ne(),t(Se,ge)},$$slots:{default:!0}})})}t(ve,W)},$$slots:{default:!0}})});var A=f(j,2);i(A,()=>Re,(w,k)=>{k(w,{})});var x=f(A,2);i(x,()=>je,(w,k)=>{k(w,{children:(ve,Ae)=>{var W=y(),_e=a(W);{let pe=p(()=>`/namespaces/${e(n)}/operators/${e(u)}`);i(_e,()=>Je,(we,Me)=>{Me(we,{get href(){return e(pe)},children:(Se,Be)=>{var ge=y(),Ne=a(ge);{var Oe=$e=>{Fe($e,{class:"h-4 w-24"})},Pe=$e=>{var He=Y();de(()=>ue(He,e($)?.name)),t($e,He)};H(Ne,$e=>{e(_)?$e(Oe):$e(Pe,!1)})}t(Se,ge)},$$slots:{default:!0}})})}t(ve,W)},$$slots:{default:!0}})});var T=f(x,2);i(T,()=>Re,(w,k)=>{k(w,{})});var P=f(T,2);i(P,()=>je,(w,k)=>{k(w,{children:(ve,Ae)=>{var W=y(),_e=a(W);{let pe=p(()=>`/namespaces/${e(n)}/operators/${e(u)}?tab=3`);i(_e,()=>Je,(we,Me)=>{Me(we,{get href(){return e(pe)},children:(Se,Be)=>{ne();var ge=Y("Accounts");t(Se,ge)},$$slots:{default:!0}})})}t(ve,W)},$$slots:{default:!0}})});var se=f(P,2);i(se,()=>Re,(w,k)=>{k(w,{})});var U=f(se,2);i(U,()=>je,(w,k)=>{k(w,{children:(ve,Ae)=>{var W=y(),_e=a(W);i(_e,()=>_t,(pe,we)=>{we(pe,{children:(Me,Se)=>{var Be=y(),ge=a(Be);{var Ne=Pe=>{Fe(Pe,{class:"h-4 w-24"})},Oe=Pe=>{var $e=Y();de(()=>ue($e,e(d)?.name)),t(Pe,$e)};H(ge,Pe=>{e(_)?Pe(Ne):Pe(Oe,!1)})}t(Me,Be)},$$slots:{default:!0}})}),t(ve,W)},$$slots:{default:!0}})}),t(ae,X)},$$slots:{default:!0}})}),t(O,ie)},$$slots:{default:!0}})});var Q=f(L,2),V=Te(Q);{var S=C=>{Fe(C,{class:"h-9 w-48"})},re=C=>{var D=Jt(),O=Te(D,!0);Ie(D),de(()=>ue(O,e(d)?.name)),t(C,D)};H(V,C=>{e(_)?C(S):C(re,!1)})}Ie(Q);var le=f(Q,2);ht(le,{tabNames:["Overview","Users","Streams"],children:(D,O=lt)=>{var fe=y(),ie=a(fe);{var be=J=>{Ge(J,{children:(ae,ye)=>{var X=y(),j=a(X);{var A=x=>{kt(x,{get loading(){return e(_)},set loading(T){r(_,T,!0)},get account(){return e(d)},set account(T){r(d,T,!0)}})};H(j,x=>{e(d)&&x(A)})}t(ae,X)}})},Le=J=>{var ae=y(),ye=a(ae);{var X=A=>{Ge(A,{children:(x,T)=>{Mt(x,{get users(){return e(z)},onloadmore:K,get loading(){return e(_)},set loading(P){r(_,P,!0)},get openCreateModal(){return e(M)},set openCreateModal(P){r(M,P,!0)},get hasMore(){return e(s)},set hasMore(P){r(s,P,!0)},get loadingMore(){return e(R)},set loadingMore(P){r(R,P,!0)}})}})},j=A=>{var x=y(),T=a(x);{var P=se=>{Ge(se,{children:(U,w)=>{var k=y(),ve=a(k);{var Ae=W=>{{let _e=p(()=>!e($).status.connected);Bt(W,{get streams(){return e(c)},get accountId(){return e(v)},get operatorId(){return e(u)},get disabled(){return e(_e)},get loading(){return e(g)},set loading(pe){r(g,pe,!0)}})}};H(ve,W=>{e($)&&W(Ae)})}t(U,k)}})};H(T,se=>{O()===3&&se(P)},!0)}t(A,x)};H(ye,A=>{O()===2?A(X):A(j,!1)},!0)}t(J,ae)};H(ie,J=>{O()===1?J(be):J(Le,!1)})}t(D,fe)},$$slots:{default:!0}}),t(l,h)};H(N,l=>{e(b)?l(G):l(q,!1)})}Ie(me);var te=f(me,2);{let l=p(()=>e(d)?.id??""),h=p(()=>e(d)?.limits.user_jwt_duration_secs);zt(te,{get accountId(){return e(l)},get accountUserJWTLifetime(){return e(h)},get users(){return e(z)},set users(L){r(z,L,!0)},get open(){return e(M)},set open(L){r(M,L,!0)}})}t(ee,ce),Ee()}export{fr as component};
