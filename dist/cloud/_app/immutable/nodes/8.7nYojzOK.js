import"../chunks/DsnmJJEf.js";import{o as He}from"../chunks/BMX_zOea.js";import{p as me,f as _,g as e,u as v,s as g,n as ce,t as ye,a as fe,d as M,h as de,c as ie,b as r,r as ue,e as Re}from"../chunks/BkBo4zcc.js";import{c as C,f as j,t as se,s as be,a as s}from"../chunks/UR9opbve.js";import{p as B,i as G}from"../chunks/BLQyWBbh.js";import{c as w}from"../chunks/UE325Gli.js";import{B as Qe,a as he,b as Ee,H as Ve,S as Le,c as Xe}from"../chunks/CNHvmY6Q.js";import{e as Ye,E as ze,L as Ke,I as Je,s as we}from"../chunks/BmSp21oe.js";import{C as Fe,d as Se,S as Oe,E as Ze,B as Be,f as et,g as tt,h as je}from"../chunks/BSDPg2RR.js";import{E as rt,a as at,A as st}from"../chunks/HfLnpeWx.js";import{n as We}from"../chunks/BBnCHKX8.js";import{C as Me}from"../chunks/BdUt5oNp.js";import{g as ot}from"../chunks/CJaZbmbJ.js";import{f as nt}from"../chunks/CrH7mYYb.js";import{U as lt}from"../chunks/MfeAfkhf.js";import{E as it}from"../chunks/DjxZdDEO.js";import{p as ke}from"../chunks/6Y7EZEcW.js";var ut=j("<!> <!> <!>",1);function ct(k,o){me(o,!0);let t=B(o,"loading",15,!0),n=B(o,"openCreateModal",15,!1),m=B(o,"hasMore",15,!1),u=B(o,"loadingMore",15,!1);const h=["ID","Name","Public Key",""];{let E=v(()=>o.users.length===0);rt(k,{entityType:"user",get columns(){return h},get isEmpty(){return e(E)},get onloadmore(){return o.onloadmore},get loading(){return t()},set loading(f){t(f)},get openCreateModal(){return n()},set openCreateModal(f){n(f)},get hasMore(){return m()},set hasMore(f){m(f)},get loadingMore(){return u()},set loadingMore(f){u(f)},children:(f,c)=>{var d=C(),y=_(d);Ye(y,19,()=>o.users,$=>$.id,($,p,L)=>{{let a=v(()=>`/namespaces/${We.activeId}/operators/${e(p).operator_id}/${e(p).account_id}/${e(p).id}`),l=v(()=>e(L)<o.users.length-1);at($,{get href(){return e(a)},get bottomBorder(){return e(l)},children:(i,pe)=>{var z=ut(),ve=_(z);w(ve,()=>Se,(S,T)=>{T(S,{children:(D,_e)=>{{let K=v(()=>`user-id-${e(p).id}`),oe=v(()=>e(p).id??"");Fe(D,{get spanId(){return e(K)},get text(){return e(oe)}})}},$$slots:{default:!0}})});var ge=g(ve,2);w(ge,()=>Se,(S,T)=>{T(S,{children:(D,_e)=>{ce();var K=se();ye(()=>be(K,e(p).name)),s(D,K)},$$slots:{default:!0}})});var b=g(ge,2);w(b,()=>Se,(S,T)=>{T(S,{children:(D,_e)=>{{let K=v(()=>`user-pk-${e(p).id}`),oe=v(()=>e(p).public_key??"");Fe(D,{get spanId(){return e(K)},get text(){return e(oe)}})}},$$slots:{default:!0}})}),s(i,z)},$$slots:{default:!0}})}}),s(f,d)},$$slots:{default:!0}})}fe()}var dt=j('<h3 class="col-span-2 text-lg font-medium">General</h3> <div class="col-span-2"><!> <!></div> <!> <!>',1);function mt(k,o){me(o,!0);let t=B(o,"open",15,!1),n=B(o,"account",15),m=M(!1),u=M(de(n().name)),h=M(de(n().limits?{subscriptions:n().limits.subscriptions,payload_size:n().limits.payload_size,imports:n().limits.imports,exports:n().limits.exports,connections:n().limits.connections,user_jwt_duration_secs:n().limits.user_jwt_duration_secs}:{}));const E=new Me;async function f(c){c.preventDefault();try{r(m,!0),n(await E.updateAccount(n().id,{name:e(u),limits:e(h)})),t(!1)}catch(d){we(d)}finally{r(m,!1)}}ze(k,{entityType:"account",modalType:"edit",get entityName(){return n().name},onsubmit:f,get open(){return t()},set open(c){t(c)},get loading(){return e(m)},set loading(c){r(m,c,!0)},children:(c,d)=>{var y=dt(),$=g(_(y),2),p=ie($);Ke(p,{for:"name",class:"mb-2",children:(i,pe)=>{ce();var z=se("Name");s(i,z)},$$slots:{default:!0}});var L=g(p,2);Je(L,{name:"name",placeholder:"Type account name",required:!0,get value(){return e(u)},set value(i){r(u,i,!0)}}),ue($);var a=g($,2);Oe(a,{class:"col-span-2 my-2"});var l=g(a,2);st(l,{get limits(){return e(h)},set limits(i){r(h,i,!0)}}),s(c,y)},$$slots:{default:!0}}),fe()}var ft=j("<!> <!>",1);function pt(k,o){me(o,!0);let t=B(o,"account",15),n=B(o,"loading",15,!0),m=M(!1);const u=["ID","Public Key"],h=["ID","Public Key"],E=["Subscriptions","Payload Size (KiB)","Imports","Exports","Connections","User JWT Lifetime"],f=v(()=>{const a=new Map;if(t())a.set("ID",t().id),a.set("Public Key",t().public_key);else for(const l of h)a.set(l,"Unknown");return a}),c=v(()=>{const a=new Map;if(t()){const l=i=>i===-1?void 0:i;a.set("Subscriptions",l(t().limits.subscriptions)),a.set("Payload Size (KiB)",l(t().limits.payload_size)),a.set("Imports",l(t().limits.imports)),a.set("Exports",l(t().limits.exports)),a.set("Connections",l(t().limits.connections)),a.set("User JWT Lifetime",nt(t().limits.user_jwt_duration_secs))}else for(const l of E)a.set(l,"Unknown");return a});async function d(){await new Me().deleteAccount(t().id),await ot(`/namespaces/${We.activeId}/operators/${t().operator_id}?tab=3`)}var y=ft(),$=_(y);{let a=v(()=>t()?.name),l=v(()=>t()?.jwt);Ze($,{editable:!0,get name(){return e(a)},get copyableFields(){return u},get data(){return e(f)},get limits(){return e(c)},get jwt(){return e(l)},deleteCallback:d,get loading(){return n()},set loading(i){n(i)},get openEditModal(){return e(m)},set openEditModal(i){r(m,i,!0)}})}var p=g($,2);{var L=a=>{mt(a,{get open(){return e(m)},set open(l){r(m,l,!0)},get account(){return t()},set account(l){t(l)}})};G(p,a=>{t()&&a(L)})}s(k,y),fe()}var vt=j('<h3 class="col-span-2 text-lg font-medium">General</h3> <div class="col-span-2"><!> <!></div> <!> <!>',1);function gt(k,o){me(o,!0);let t=B(o,"open",15,!1),n=B(o,"users",31,()=>de([])),m=M(!1),u=M(""),h=M(de({}));const E=new Me;async function f(c){c.preventDefault();try{r(m,!0);const d=await E.createUser(o.accountId,{name:e(u),limits:e(h)});n([d,...n()]),r(u,""),r(h,{},!0),t(!1)}catch(d){we(d)}finally{r(m,!1)}}ze(k,{entityType:"user",modalType:"create",onsubmit:f,get open(){return t()},set open(c){t(c)},get loading(){return e(m)},set loading(c){r(m,c,!0)},children:(c,d)=>{var y=vt(),$=g(_(y),2),p=ie($);Ke(p,{for:"name",class:"mb-2",children:(i,pe)=>{ce();var z=se("Name");s(i,z)},$$slots:{default:!0}});var L=g(p,2);Je(L,{name:"name",placeholder:"Type user name",required:!0,get value(){return e(u)},set value(i){r(u,i,!0)}}),ue($);var a=g($,2);Oe(a,{class:"col-span-2 my-2"});var l=g(a,2);lt(l,{get accountUserJWTLifetime(){return o.accountUserJWTLifetime},get limits(){return e(h)},set limits(i){r(h,i,!0)}}),s(c,y)},$$slots:{default:!0}}),fe()}var _t=j("<!> Operators",1),$t=j("<!> <!> <!> <!> <!> <!> <!>",1),ht=j('<h1 class="text-3xl font-bold"> </h1>'),yt=j('<!> <div class="mb-6"><!></div> <!>',1),bt=j("<main><!></main> <!>",1);function jt(k,o){me(o,!0);const t=v(()=>ke.params.namespace??""),n=v(()=>ke.params.operator??""),m=v(()=>ke.params.account??"");let u=M(!0),h=M(!1),E=M(!1),f=M(!1),c=M(void 0),d=M(void 0),y=M(de([])),$=M(!1);const p=new Me,L=v(()=>p.paginateUsers(e(m)));He(async()=>{r(u,!0);try{r(c,await p.fetchOperator(e(n)),!0),r(d,await p.fetchAccount(e(m)),!0),await a()}catch(b){we(b),r(E,!0)}finally{r(u,!1)}});async function a(){r(h,!0);try{const b=await e(L).fetchNext();r(y,[...e(y),...b],!0),r($,e(L).hasNext(),!0)}catch(b){we(b)}finally{r(h,!1)}}var l=bt(),i=_(l),pe=ie(i);{var z=b=>{it(b)},ve=b=>{var S=yt(),T=_(S);w(T,()=>Xe,(A,q)=>{q(A,{class:"mb-8",children:(ee,xe)=>{var $e=C(),Pe=_($e);w(Pe,()=>Qe,(Ie,J)=>{J(Ie,{children:(te,Te)=>{var H=$t(),O=_(H);w(O,()=>he,(P,I)=>{I(P,{children:(Q,Ue)=>{var U=C(),V=_(U);{let X=v(()=>`/namespaces/${e(t)}/operators`);w(V,()=>Ee,(Y,Z)=>{Z(Y,{get href(){return e(X)},class:"flex items-center gap-2",children:(ae,ne)=>{var N=_t(),le=_(N);Ve(le,{class:"size-4"}),ce(),s(ae,N)},$$slots:{default:!0}})})}s(Q,U)},$$slots:{default:!0}})});var re=g(O,2);w(re,()=>Be,(P,I)=>{I(P,{})});var R=g(re,2);w(R,()=>he,(P,I)=>{I(P,{children:(Q,Ue)=>{var U=C(),V=_(U);{let X=v(()=>`/namespaces/${e(t)}/operators/${e(n)}`);w(V,()=>Ee,(Y,Z)=>{Z(Y,{get href(){return e(X)},children:(ae,ne)=>{var N=C(),le=_(N);{var Ce=F=>{Le(F,{class:"h-4 w-24"})},W=F=>{var Ne=se();ye(()=>be(Ne,e(c)?.name)),s(F,Ne)};G(le,F=>{e(u)?F(Ce):F(W,!1)})}s(ae,N)},$$slots:{default:!0}})})}s(Q,U)},$$slots:{default:!0}})});var x=g(R,2);w(x,()=>Be,(P,I)=>{I(P,{})});var De=g(x,2);w(De,()=>he,(P,I)=>{I(P,{children:(Q,Ue)=>{var U=C(),V=_(U);{let X=v(()=>`/namespaces/${e(t)}/operators/${e(n)}?tab=3`);w(V,()=>Ee,(Y,Z)=>{Z(Y,{get href(){return e(X)},children:(ae,ne)=>{ce();var N=se("Accounts");s(ae,N)},$$slots:{default:!0}})})}s(Q,U)},$$slots:{default:!0}})});var Ae=g(De,2);w(Ae,()=>Be,(P,I)=>{I(P,{})});var qe=g(Ae,2);w(qe,()=>he,(P,I)=>{I(P,{children:(Q,Ue)=>{var U=C(),V=_(U);w(V,()=>et,(X,Y)=>{Y(X,{children:(Z,ae)=>{var ne=C(),N=_(ne);{var le=W=>{Le(W,{class:"h-4 w-24"})},Ce=W=>{var F=se();ye(()=>be(F,e(d)?.name)),s(W,F)};G(N,W=>{e(u)?W(le):W(Ce,!1)})}s(Z,ne)},$$slots:{default:!0}})}),s(Q,U)},$$slots:{default:!0}})}),s(te,H)},$$slots:{default:!0}})}),s(ee,$e)},$$slots:{default:!0}})});var D=g(T,2),_e=ie(D);{var K=A=>{Le(A,{class:"h-9 w-48"})},oe=A=>{var q=ht(),ee=ie(q,!0);ue(q),ye(()=>be(ee,e(d)?.name)),s(A,q)};G(_e,A=>{e(u)?A(K):A(oe,!1)})}ue(D);var Ge=g(D,2);tt(Ge,{tabNames:["Overview","Users"],children:(q,ee=Re)=>{var xe=C(),$e=_(xe);{var Pe=J=>{je(J,{children:(te,Te)=>{var H=C(),O=_(H);{var re=R=>{pt(R,{get loading(){return e(u)},set loading(x){r(u,x,!0)},get account(){return e(d)},set account(x){r(d,x,!0)}})};G(O,R=>{e(d)&&R(re)})}s(te,H)}})},Ie=J=>{var te=C(),Te=_(te);{var H=O=>{je(O,{children:(re,R)=>{ct(re,{get users(){return e(y)},onloadmore:a,get loading(){return e(u)},set loading(x){r(u,x,!0)},get openCreateModal(){return e(f)},set openCreateModal(x){r(f,x,!0)},get hasMore(){return e($)},set hasMore(x){r($,x,!0)},get loadingMore(){return e(h)},set loadingMore(x){r(h,x,!0)}})}})};G(Te,O=>{ee()===2&&O(H)},!0)}s(J,te)};G($e,J=>{ee()===1?J(Pe):J(Ie,!1)})}s(q,xe)},$$slots:{default:!0}}),s(b,S)};G(pe,b=>{e(E)?b(z):b(ve,!1)})}ue(i);var ge=g(i,2);{let b=v(()=>e(d)?.id??""),S=v(()=>e(d)?.limits.user_jwt_duration_secs);gt(ge,{get accountId(){return e(b)},get accountUserJWTLifetime(){return e(S)},get users(){return e(y)},set users(T){r(y,T,!0)},get open(){return e(f)},set open(T){r(f,T,!0)}})}s(k,l),fe()}export{jt as component};
